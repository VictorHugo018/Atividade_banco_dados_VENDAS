/* Exercício 1 */
UPDATE DEBITOS d
SET d.SITUACAO_DEBITO = 'Atrasado'
WHERE d.SITUACAO_DEBITO = 'Pendente' AND d.DATAVENCIMENTO < CURRENT_DATE 





/* Exercício 2 */
UPDATE DEBITOS d
SET d.SITUACAO_DEBITO = 'Pendente'
WHERE d.SITUACAO_DEBITO <> 'Pago' AND d.DATAVENCIMENTO >= CURRENT_DATE





/* Exercício 3 */
UPDATE DEBITOS d
SET d.DATAVENCIMENTO = DATEADD(5 YEAR TO d.DATAVENCIMENTO) 
WHERE d.SITUACAO_DEBITO = 'Negociado'





/* Exercício 4 */
SELECT p.NOME, p.EMAIL, p.TELEFONE FROM PESSOA p




/* Exercício 5 */
SELECT p.PRECO_UNITARIO FROM PRODUTO p 
WHERE p.PRECO_UNITARIO > 100





/* Exercício 6 */
SELECT * FROM VENDA v
WHERE v.DATA_VENDA = '2022-06-23'





/* Exercício 7 */
SELECT p.DATA_NASCIMENTO,
       p.NOME,
       2024 - EXTRACT(YEAR FROM p.DATA_NASCIMENTO) AS IDADE
FROM PESSOA p 
WHERE p.ID_PESSOA IN (
SELECT f.ID_PESSOA 
FROM FORNECEDOR f 
WHERE f.ID_FORNECEDOR NOT IN (
SELECT p2.ID_FORNECEDOR 
FROM PRODUTO p2
)
)





/* Exercício 8 */

SELECT * FROM CLIENTE c 
WHERE c.ID_CLIENTE IN (SELECT d.ID_CLIENTE FROM DEBITOS d WHERE d.DATAVENCIMENTO < CURRENT_DATE)
AND c.ID_Cliente IN (SELECT P.ID_CLIENTE FROM PAGAMENTO p)

/* 9 não fazer */

/* Exercício 10 */

obs:não consegui fazer 





/* Exercício 11 */
UPDATE PRODUTO P
SET P.QUANTIDADE_ESTOQUE = QUANTIDADE_ESTOQUE*1.1
WHERE P.QUANTIDADE_ESTOQUE < 10






/* 12 não fazer */




/* Exercício 13 */
UPDATE DEBITOS D
SET D.SITUACAO_DEBITO = 'Pago'
WHERE D.SITUACAO_DEBITO = 'Atrasado' AND 
D.SITUACAO_DEBITO IN (SELECT P.ID_DEBITO FROM PAGAMENTO P)





/* Exercício 15 */
SELECT * FROM VENDA V
WHERE V.DATA_VENDA BETWEEN '2023-12-01' AND '2024-01-01'





/* Exercício 16 */
SELECT * FROM PRODUTO P
WHERE P.QUANTIDADE_ESTOQUE BETWEEN 5 AND 20





/* Exercício 17 */
SELECT * FROM PESSOA P
WHERE P.NOME LIKE 'A%'





/* Exercício 18 */
SELECT * FROM PRODUTO P
WHERE P.ID_PRODUTO IN (SELECT I.ID_PRODUTO FROM ITENSVENDA I
WHERE I.ID_VENDA IN (SELECT V.ID_VENDA FROM VENDA V))




/* Exercício 19 */
1SELECT * FROM PRODUTO P
RIGHT JOIN ITENSVENDA I ON I.ID_PRODUTO = P.ID_PRODUTO
RIGHT JOIN VENDA V ON V.ID_VENDA = I.ID_VENDA
WHERE V.ID_PESSOA IN (SELECT P2.ID_PESSOA FROM PESSOA P2 WHERE P2.NOME = 'Carla Souza' OR P2.NOME = 'Larissa Ferreira')




/* Exercício 20 */
SELECT * FROM PESSOA P
WHERE P.ID_PESSOA IN (SELECT C.ID_PESSOA FROM CLIENTE C) OR P.ID_PESSOA IN (SELECT F.ID_PESSOA FROM FORNECEDOR F)




/* Exercício 21 */
SELECT V.VALOR_TOTAL
, V.DATA_VENDA
, F.DESCRICAO
, C.CPF AS CPF_COMPRADOR
, P.NOME
, P.TELEFONE
, P.EMAIL
FROM VENDA V
RIGHT JOIN FORMA_PAGAMENTO F ON F.ID_FORMA_PAGAMENTO = V.ID_FORMA_PAGAMENTO
RIGHT JOIN PESSOA P ON P.ID_PESSOA = V.ID_PESSOA
RIGHT JOIN CLIENTE C ON C.ID_PESSOA = P.ID_PESSOA




/* Exercício 22 */
SELECT V.DATA_VENDA AS DATA_COMPRA
, V.VALOR_TOTAL
, P.NOME
, P.DESCRICAO
, P.PRECO_UNITARIO
FROM VENDA V
RIGHT JOIN ITENSVENDA I ON I.ID_VENDA = V.ID_VENDA 
RIGHT JOIN PRODUTO P ON P.ID_PRODUTO = I.ID_PRODUTO
WHERE P.NOME = 'Placa de Captura'




/* Exercício 23 */
SELECT P.NOME
,2025 - EXTRACT(YEAR FROM DATEADD(YEAR, 1, P.DATA_NASCIMENTO)) AS IDADE_2025
FROM PESSOA P
WHERE P.ID_PESSOA IN (SELECT F.ID_PESSOA FROM FORNECEDOR F) OR P.ID_PESSOA IN (SELECT C.ID_PESSOA FROM CLIENTE C)







/* Exercício 24 */

SELECT L.NOME AS NOME_LOGRADOURO
, B.NOME AS NOME_BAIRRO
, B.CEP
, E.ID_PESSOA 
FROM LOGRADOURO L
RIGHT JOIN ENDERECO E ON E.ID_LOGRADOURO = L.ID_LOGRADOURO 
RIGHT JOIN BAIRRO B ON B.ID_BAIRRO = L.ID_BAIRRO




/* Exercício 25 */
SELECT * FROM PRODUTO P
WHERE P.PRECO_UNITARIO > (SELECT AVG(PRODUTO.PRECO_UNITARIO) FROM PRODUTO)






/* Exercício 26 */
SELECT *
FROM PESSOA P
WHERE P.ID_PESSOA IN (SELECT E.ID_PESSOA FROM ENDERECO E
WHERE E.ID_MUNICIPIO IN (SELECT M.ID_MUNICIPIO FROM MUNICIPIO M
WHERE M.POPULACAO > 1000000))

/* Exercício 27 */


obs:não consegui fazer 




/* Exercício 28 */
SELECT P.NOME
,V.VALOR_TOTAL
FROM VENDA V
RIGHT JOIN PESSOA P ON P.ID_PESSOA = V.ID_PESSOA
WHERE V.VALOR_TOTAL > 500





/* Exercício 29 */
SELECT P.NOME
,E.NUMERO
,E.COMPLEMENTO
,L.NOME
,B.NOME
,B.CEP
FROM PESSOA P
RIGHT JOIN ENDERECO E ON E.ID_PESSOA = P.ID_PESSOA
RIGHT JOIN LOGRADOURO L ON L.ID_LOGRADOURO = E.ID_LOGRADOURO
RIGHT JOIN BAIRRO B ON B.ID_BAIRRO = L.ID_BAIRRO
WHERE E.NUMERO IS NOT NULL





/* Exercício 30 */
SELECT PES.NOME AS FORNECEDOR
,P.NOME AS PRODUTO
,P.DESCRICAO
,P.PRECO_UNITARIO
,P.QUANTIDADE_ESTOQUE
FROM PRODUTO P
INNER JOIN FORNECEDOR F ON F.ID_FORNECEDOR = P.ID_FORNECEDOR
RIGHT JOIN PESSOA PES ON PES.ID_PESSOA = F.ID_PESSOA
WHERE PES.ID_PESSOA IN (SELECT F.ID_PESSOA FROM FORNECEDOR F)





/* Exercício 31 */
SELECT * FROM PRODUTO P
ORDER BY P.QUANTIDADE_ESTOQUE DESC




/* Exercício 32 */
SELECT * FROM VENDA V
ORDER BY V.VALOR_TOTAL ASC





/* Exercício 33 */
SELECT * FROM PRODUTO P
WHERE P.QUANTIDADE_ESTOQUE < (SELECT AVG(P.QUANTIDADE_ESTOQUE) FROM PRODUTO P)





/* Exercício 34 */
SELECT P.TELEFONE, P.NOME, P.EMAIL
FROM PESSOA P
WHERE P.TELEFONE IN (SELECT TELEFONE FROM PESSOA P
GROUP BY P.TELEFONE
HAVING COUNT(*) > 1)





/* Exercício 35 */
UPDATE PRODUTO P
SET P.PRECO_UNITARIO = P.PRECO_UNITARIO *1.1
WHERE P.ID_FORNECEDOR IN (SELECT F.ID_FORNECEDOR FROM FORNECEDOR F
WHERE F.ID_PESSOA IN (SELECT P2.ID_PESSOA FROM PESSOA P2
WHERE P2.ID_PESSOA IN (SELECT E.ID_PESSOA FROM ENDERECO E
WHERE E.ID_MUNICIPIO IN (SELECT M.ID_MUNICIPIO FROM MUNICIPIO M
WHERE M.NOME = 'São Paulo'))))




/* Exercício 36 */
SELECT * FROM VENDA V
WHERE V.ID_VENDA IN (SELECT D.ID_VENDA FROM DEBITOS D
WHERE D.SITUACAO_DEBITO = 'Negociado')
